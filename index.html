<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Aadhaar vs Selfie - Face Verify</title>
    <link rel="stylesheet" href="styles.css" />
    <!-- face-api.js via CDN -->
    <script defer src="https://cdn.jsdelivr.net/npm/face-api.js@0.22.2/dist/face-api.min.js"></script>
  <!-- heic2any for in-browser HEIC/HEIF -> JPEG conversion -->
  <script defer src="https://unpkg.com/heic2any@0.6.2/dist/heic2any.min.js"></script>
    <script defer src="script.js"></script>
  </head>
  <body>
    <main class="card">
      <h1>Face Verify (Aadhaar ↔ Selfie)</h1>

      <div class="inputs">
        <label class="file-label">
          Aadhaar photo
          <input id="fileAadhaar" type="file" accept="image/*" />
          <span id="aadhaarName" class="file-name">No file chosen</span>
        </label>

        <label class="file-label">
          Selfie
          <input id="fileSelfie" type="file" accept="image/*" />
          <span id="selfieName" class="file-name">No file chosen</span>
        </label>
      </div>

      <div class="previews">
        <div class="preview">
          <canvas id="canvasAadhaar"></canvas>
          <div class="caption">Aadhaar</div>
        </div>
        <div class="preview">
          <canvas id="canvasSelfie"></canvas>
          <div class="caption">Selfie</div>
        </div>
      </div>

      <div class="options">
        <label><input id="permissive" type="checkbox" /> Use permissive detector (may find low-quality faces)</label>
        <label class="threshold">Match threshold: <span id="thresholdVal">0.600</span></label>
        <input id="thresholdRange" type="range" min="0.30" max="0.80" step="0.01" value="0.60" />
      </div>

      <button id="verifyBtn" class="btn" disabled>Verify</button>

      <div id="result" class="result">Models will load automatically. Processing stays local.</div>

      <div class="note">All processing is local — images are never uploaded.</div>
    </main>
    <style>
    /* Chatbot container styles */
    .chat-container {
        display: none;
        position: fixed;
        bottom: 100px;
        right: 30px;
        width: 350px;
        max-width: 90%;
        height: 500px;
        background-color: #ffffff;
        border-radius: 15px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        flex-direction: column;
        overflow: hidden;
        font-family: Arial, sans-serif;
        z-index: 1000;
        transition: all 0.3s ease-in-out;
    }

    /* Chatbot header */
    .chat-header {
        background: linear-gradient(135deg, #6f00ff, #a855f7); /* Purple gradient */
        color: white;
        padding: 15px;
        text-align: center;
        font-size: 1.2em;
        font-weight: bold;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .chat-header .close-btn {
        cursor: pointer;
        font-size: 1.5em;
        font-weight: bold;
    }

    /* Messages area */
    .chat-messages {
        flex-grow: 1;
        padding: 20px;
        overflow-y: auto;
        display: flex;
        flex-direction: column;
        gap: 15px;
        background-color: #f9f9f9;
    }

    /* Individual message bubble */
    .message {
        padding: 10px 15px;
        border-radius: 20px;
        max-width: 80%;
        line-height: 1.4;
    }

    .message.user {
        background-color: #a855f7;
        color: white;
        align-self: flex-end;
        border-bottom-right-radius: 5px;
    }

    .message.bot {
        background-color: #e5e7eb;
        color: #333;
        align-self: flex-start;
        border-bottom-left-radius: 5px;
    }

    /* Input area */
    .chat-input {
        display: flex;
        padding: 15px;
        border-top: 1px solid #ddd;
        background-color: #fff;
    }

    .chat-input input {
        flex-grow: 1;
        border: 1px solid #ccc;
        border-radius: 20px;
        padding: 10px 15px;
        font-size: 1em;
        margin-right: 10px;
        outline: none;
    }
     .chat-input input:focus {
        border-color: #a855f7;
     }

    .chat-input button {
        background-color: #a855f7;
        border: none;
        color: white;
        padding: 10px 15px;
        border-radius: 50%;
        cursor: pointer;
        font-size: 1.2em;
        transition: background-color 0.2s;
    }

    .chat-input button:hover {
        background-color: #6f00ff;
    }
    
    /* Chat icon to open the chat */
    .chat-icon {
        position: fixed;
        bottom: 30px;
        right: 30px;
        width: 60px;
        height: 60px;
        background: linear-gradient(135deg, #6f00ff, #a855f7);
        color: white;
        display: flex;
        justify-content: center;
        align-items: center;
        border-radius: 50%;
        cursor: pointer;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        font-size: 24px;
        z-index: 1000;
    }
    
    /* --- NEW --- Typing indicator styles */
    .typing-indicator {
        display: flex;
        align-items: center;
        padding: 10px 0;
    }
    .typing-indicator span {
        height: 8px;
        width: 8px;
        background-color: #9ca3af;
        border-radius: 50%;
        display: inline-block;
        margin: 0 2px;
        animation: bounce 1.4s infinite ease-in-out both;
    }
    .typing-indicator span:nth-child(1) { animation-delay: -0.32s; }
    .typing-indicator span:nth-child(2) { animation-delay: -0.16s; }

    @keyframes bounce {
      0%, 80%, 100% { transform: scale(0); }
      40% { transform: scale(1.0); }
    }
    
</style>

<div class="chat-icon" onclick="toggleChat()">
    <svg xmlns="http://www.w3.org/2000/svg" fill="white" height="28" viewBox="0 96 960 960" width="28"><path d="M240 776h360v-80H240v80Zm0-160h480v-80H240v80Zm0-160h480v-80H240v80ZM80 976V256q0-33 23.5-56.5T160 176h640q33 0 56.5 23.5T880 256v480q0 33-23.5 56.5T800 816H240L80 976Z"/></svg>
</div>

<div class="chat-container" id="chatContainer">
    <div class="chat-header">
        <span>Chat with us!</span>
        <span class="close-btn" onclick="toggleChat()">×</span>
    </div>
    <div class="chat-messages" id="chatMessages">
        <div class="message bot">Hello! How can I help you today?</div>
    </div>
    <div class="chat-input">
        <input type="text" id="userInput" placeholder="Type a message..." onkeyup="checkEnter(event)">
        <button onclick="sendMessage()">&#9658;</button>
    </div>
</div>


<script>
    const chatContainer = document.getElementById('chatContainer');
    const chatMessages = document.getElementById('chatMessages');
    const userInput = document.getElementById('userInput');

    // Function to toggle chat window
    function toggleChat() {
        chatContainer.style.display = (chatContainer.style.display === 'none' || chatContainer.style.display === '') ? 'flex' : 'none';
    }

    // Function to send a message
    function sendMessage() {
        const messageText = userInput.value.trim();
        if (messageText === '') return;

        addMessage(messageText, 'user');
        userInput.value = '';

        // --- MODIFIED --- Show typing indicator and get bot response
        showTypingIndicator();
        
        setTimeout(() => {
            hideTypingIndicator();
            const botResponse = getBotResponse(messageText);
            addMessage(botResponse, 'bot');
        }, 1200); // Simulate bot thinking for 1.2 seconds
    }
    
    // Function to add a message to the chat
    function addMessage(text, sender) {
        const messageElement = document.createElement('div');
        messageElement.className = `message ${sender}`;
        messageElement.textContent = text;
        chatMessages.appendChild(messageElement);
        chatMessages.scrollTop = chatMessages.scrollHeight;
    }

    // --- NEW --- Function to show the typing indicator
    function showTypingIndicator() {
        const indicatorElement = document.createElement('div');
        indicatorElement.className = 'message bot';
        indicatorElement.id = 'typingIndicator';
        indicatorElement.innerHTML = `
            <div class="typing-indicator">
                <span></span>
                <span></span>
                <span></span>
            </div>
        `;
        chatMessages.appendChild(indicatorElement);
        chatMessages.scrollTop = chatMessages.scrollHeight;
    }

    // --- NEW --- Function to hide the typing indicator
    function hideTypingIndicator() {
        const indicatorElement = document.getElementById('typingIndicator');
        if (indicatorElement) {
            indicatorElement.remove();
        }
    }

    // Function to handle Enter key press
    function checkEnter(event) {
        if (event.key === 'Enter') {
            sendMessage();
        }
    }

    // --- BOT'S BRAIN ---
    function getBotResponse(userText) {
        const lowerUserText = userText.toLowerCase();

        if (lowerUserText.includes('hello') || lowerUserText.includes('hi')) {
            return 'Hello there! How can I assist you?';
        }
        if (lowerUserText.includes('pricing') || lowerUserText.includes('price')) {
            return 'You can find all our pricing details on the pricing page. Would you like a link?';
        }
        if (lowerUserText.includes('services')) {
            return 'We offer a wide range of services including web development, app development, and digital marketing.';
        }
        if (lowerUserText.includes('contact') || lowerUserText.includes('support')) {
            return 'You can reach our support team at support@example.com or by calling 555-1234.';
        }
        if (lowerUserText.includes('bye') || lowerUserText.includes('goodbye')) {
            return 'Goodbye! Have a great day!';
        }
        return "I'm sorry, I didn't quite understand that. Could you please rephrase? You can ask me about our services, pricing, or how to contact support.";
    }
</script>
  </body>
</html>
